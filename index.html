<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>البحث برقم الوحدة</title>
  <style>
    body {
      font-family: Arial;
      direction: rtl;
      text-align: center;
      padding: 30px;
    }
    .dropdown {
      position: relative;
      width: 300px;
      margin: 0 auto;
    }
    #unitInput {
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }
    #suggestions {
      border: 1px solid #ccc;
      border-top: none;
      max-height: 200px;
      overflow-y: auto;
      position: absolute;
      background: white;
      width: 100%;
      z-index: 1000;
    }
    .suggestion {
      padding: 8px;
      cursor: pointer;
    }
    .suggestion:hover {
      background-color: #eee;
    }
  </style>
</head>
<body>
  <h2>ابحث عن بيانات الوحدة</h2>
  <div class="dropdown">
    <input type="text" id="unitInput" placeholder="اكتب رقم الوحدة هنا">
    <div id="suggestions"></div>
  </div>
  <div id="result" style="margin-top: 20px;"></div>

  <script>
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRQ-2rfpVKsouOZUzwbzViyos6H5lezDoSdVMsXfdupIcaUVM6GiS9cb9-Hq6mM4dy5diESIIPwt1b6/pub?gid=612505877&single=true&output=csv';
    const input = document.getElementById('unitInput');
    const suggestions = document.getElementById('suggestions');
    const resultDiv = document.getElementById('result');
    let rows = [];

    fetch(csvUrl)
      .then(res => res.text())
      .then(data => {
        rows = data.trim().split('\n').map(r => r.split(','));
        rows.shift(); // Remove headers
      });

    input.addEventListener('input', () => {
      const val = input.value.trim();
      suggestions.innerHTML = '';
      if (val === '') return;

      const matches = rows.filter(r => r[0].includes(val));
      matches.forEach(row => {
        const div = document.createElement('div');
        div.classList.add('suggestion');
        div.textContent = row[0];
        div.addEventListener('click', () => {
          input.value = row[0];
          suggestions.innerHTML = '';
          resultDiv.innerHTML = `<p><strong>النتيجة:</strong> ${row[1]}</p>`;
        });
        suggestions.appendChild(div);
      });

      if (matches.length === 0) {
        suggestions.innerHTML = '<div class="suggestion">لا توجد نتائج</div>';
      }
    });

    // إغلاق القائمة عند النقر خارجها
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.dropdown')) {
        suggestions.innerHTML = '';
      }
    });
  </script>
</body>
</html>
